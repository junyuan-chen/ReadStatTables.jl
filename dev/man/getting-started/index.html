<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · ReadStatTables.jl</title><meta name="title" content="Getting Started · ReadStatTables.jl"/><meta property="og:title" content="Getting Started · ReadStatTables.jl"/><meta property="twitter:title" content="Getting Started · ReadStatTables.jl"/><meta name="description" content="Documentation for ReadStatTables.jl."/><meta property="og:description" content="Documentation for ReadStatTables.jl."/><meta property="twitter:description" content="Documentation for ReadStatTables.jl."/><meta property="og:url" content="https://junyuan-chen.github.io/ReadStatTables.jl/stable/man/getting-started/"/><meta property="twitter:url" content="https://junyuan-chen.github.io/ReadStatTables.jl/stable/man/getting-started/"/><link rel="canonical" href="https://junyuan-chen.github.io/ReadStatTables.jl/stable/man/getting-started/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ReadStatTables.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Reading-a-Data-File"><span>Reading a Data File</span></a></li><li><a class="tocitem" href="#Accessing-Individual-Objects"><span>Accessing Individual Objects</span></a></li><li><a class="tocitem" href="#Type-Conversions"><span>Type Conversions</span></a></li><li><a class="tocitem" href="#Writing-a-Data-File"><span>Writing a Data File</span></a></li><li><a class="tocitem" href="#More-Options"><span>More Options</span></a></li></ul></li><li><a class="tocitem" href="../table-interface/">Table Interface</a></li><li><a class="tocitem" href="../metadata/">Metadata</a></li><li><a class="tocitem" href="../value-labels/">Value Labels</a></li><li><a class="tocitem" href="../date-and-time-values/">Date and Time Values</a></li></ul></li><li><span class="tocitem">About</span><ul><li><a class="tocitem" href="../../license/">License</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/junyuan-chen/ReadStatTables.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/main/docs/src/man/getting-started.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><p>An overview of the usage of <a href="https://github.com/junyuan-chen/ReadStatTables.jl">ReadStatTables.jl</a> is provided below. For instructions on installation, see <a href="../../#Installation">Installation</a>.</p><h2 id="Reading-a-Data-File"><a class="docs-heading-anchor" href="#Reading-a-Data-File">Reading a Data File</a><a id="Reading-a-Data-File-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-a-Data-File" title="Permalink"></a></h2><p>Suppose we have a Stata <code>.dta</code> file located at <code>data/sample.dta</code>. To read this file into Julia:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using ReadStatTables</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; tb = readstat(&quot;data/sample.dta&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">5×7 ReadStatTable:
<span class="sgr1"> Row │  mychar    mynum      mydate                dtime         mylabl        ⋯
     │<span class="sgr90"> String3  Float64       Date?            DateTime?  Labeled{Int8}  Label ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │       a      1.1  2018-05-06  2018-05-06T10:10:10           Male        ⋯
   2 │       b      1.2  1880-05-06  1880-05-06T10:10:10         Female        ⋯
   3 │       c  -1000.3  1960-01-01  1960-01-01T00:00:00           Male        ⋯
   4 │       d     -1.4  1583-01-01  1583-01-01T00:00:00         Female        ⋯
   5 │       e   1000.3     missing              missing           Male        ⋯
</span><span class="sgr36">                                                               2 columns omitted</span></span></code></pre><p>Here is how we read the above result:<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><ul><li>Variable names from the data file are displayed in the first row.</li><li>Element type of each variable is displayed below the corresponding variable name.</li><li>The values of each variable are displayed column-wise starting from the third row.</li></ul><p>Some additional details to be noted:</p><ul><li>If a variable contains any missing value, there is a question mark <code>?</code> in the displayed element type.</li><li>By default, all missing values are treated as <a href="https://docs.julialang.org/en/v1/manual/missing/"><code>missing</code></a>, a special value in Julia.</li><li>The date and time values have been translated into <code>Date</code> and <code>DateTime</code> respectively.<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></li><li>Labels instead of the numeric values are displayed for variables with value labels.</li><li><code>Labeled{Int8}</code> is an abbreviation for <a href="../value-labels/#ReadStatTables.LabeledValue"><code>LabeledValue{Int8}</code></a>.</li></ul><h2 id="Accessing-Individual-Objects"><a class="docs-heading-anchor" href="#Accessing-Individual-Objects">Accessing Individual Objects</a><a id="Accessing-Individual-Objects-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Individual-Objects" title="Permalink"></a></h2><p>A vector of all variable names can be obtained as follows:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; columnnames(tb)</code><code class="nohighlight hljs ansi" style="display:block;">7-element Vector{Symbol}:
 :mychar
 :mynum
 :mydate
 :dtime
 :mylabl
 :myord
 :mytime</code></pre><p>To retrieve the array containing data for a specific variable:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; tb.mylabl</code><code class="nohighlight hljs ansi" style="display:block;">5-element LabeledVector{Union{Missing, Int8}, Vector{Union{Missing, Int8}}, Union{Char, Int32}}:
 1 =&gt; Male
 2 =&gt; Female
 1 =&gt; Male
 2 =&gt; Female
 1 =&gt; Male</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The returned array is exactly the same array holding the data for the table. Therefore, modifying elements in the returned array will also change the data in the table. To avoid such changes, please <a href="https://docs.julialang.org/en/v1/base/base/#Base.copy"><code>copy</code></a> the array first.</p></div></div><p>Metadata for the data file can be accessed from <code>tb</code> using methods that are compatible with <a href="https://github.com/JuliaData/DataAPI.jl">DataAPI.jl</a>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; metadata(tb)</code><code class="nohighlight hljs ansi" style="display:block;">ReadStatMeta:
  row count           =&gt; 5
  var count           =&gt; 7
  modified time       =&gt; 2021-04-22T21:36:00
  file format version =&gt; 118
  file label          =&gt; A test file
  file extension      =&gt; .dta</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colmetadata(tb)</code><code class="nohighlight hljs ansi" style="display:block;">ColMetaIterator{ReadStatColMeta} with 7 entries:
  :mychar =&gt; ReadStatColMeta(character, %-1s)
  :mynum  =&gt; ReadStatColMeta(numeric, %16.2f)
  :mydate =&gt; ReadStatColMeta(date, %td)
  :dtime  =&gt; ReadStatColMeta(datetime, %tc)
  :mylabl =&gt; ReadStatColMeta(labeled, %16.0f)
  :myord  =&gt; ReadStatColMeta(ordinal, %16.0f)
  :mytime =&gt; ReadStatColMeta(time, %tcHH:MM:SS)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colmetadata(tb, :myord)</code><code class="nohighlight hljs ansi" style="display:block;">ReadStatColMeta:
  label         =&gt; ordinal
  format        =&gt; %16.0f
  type          =&gt; READSTAT_TYPE_INT8
  value label   =&gt; myord
  storage width =&gt; 1
  display width =&gt; 16
  measure       =&gt; READSTAT_MEASURE_UNKNOWN
  alignment     =&gt; READSTAT_ALIGNMENT_RIGHT</code></pre><h2 id="Type-Conversions"><a class="docs-heading-anchor" href="#Type-Conversions">Type Conversions</a><a id="Type-Conversions-1"></a><a class="docs-heading-anchor-permalink" href="#Type-Conversions" title="Permalink"></a></h2><p>The interface provided by ReadStatTables.jl allows basic tasks. In case more complicated operations are needed, it is easy to convert the objects into other types.</p><h3 id="Converting-ReadStatTable"><a class="docs-heading-anchor" href="#Converting-ReadStatTable">Converting ReadStatTable</a><a id="Converting-ReadStatTable-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-ReadStatTable" title="Permalink"></a></h3><p>The table returned by <a href="#ReadStatTables.readstat"><code>readstat</code></a> is a <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a>. Converting a <code>ReadStatTable</code> to another table type is easy, thanks to the widely supported <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a> interface.</p><p>For example, to convert a <code>ReadStatTable</code> to a <code>DataFrame</code> from <a href="https://github.com/JuliaData/DataFrames.jl">DataFrames.jl</a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df = DataFrame(tb)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">5×7 DataFrame
 Row │ mychar   mynum    mydate      dtime                mylabl     myord     ⋯
     │<span class="sgr90"> String3  Float64  Date?       DateTime?            LabeledV…  LabeledV… ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ a            1.1  2018-05-06  2018-05-06T10:10:10  Male       low       ⋯
   2 │ b            1.2  1880-05-06  1880-05-06T10:10:10  Female     medium
   3 │ c        -1000.3  1960-01-01  1960-01-01T00:00:00  Male       high
   4 │ d           -1.4  1583-01-01  1583-01-01T00:00:00  Female     low
   5 │ e         1000.3  missing     missing              Male       missing   ⋯
</span><span class="sgr36">                                                                1 column omitted</span></span></code></pre><p>Metadata contained in a <code>ReadStatTable</code> are preserved in the converted <code>DataFrame</code> when working with DataFrames.jl version <code>v1.4.0</code> or above, which supports the same <a href="https://github.com/JuliaData/DataAPI.jl">DataAPI.jl</a> interface for metadata:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; metadata(df)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, Any} with 13 entries:
  &quot;file_ext&quot;             =&gt; &quot;.dta&quot;
  &quot;modified_time&quot;        =&gt; DateTime(&quot;2021-04-22T21:36:00&quot;)
  &quot;file_format_version&quot;  =&gt; 118
  &quot;file_format_is_64bit&quot; =&gt; true
  &quot;table_name&quot;           =&gt; &quot;&quot;
  &quot;notes&quot;                =&gt; String[]
  &quot;file_encoding&quot;        =&gt; &quot;&quot;
  &quot;file_label&quot;           =&gt; &quot;A test file&quot;
  &quot;var_count&quot;            =&gt; 7
  &quot;row_count&quot;            =&gt; 5
  &quot;creation_time&quot;        =&gt; DateTime(&quot;2021-04-22T21:36:00&quot;)
  &quot;endianness&quot;           =&gt; READSTAT_ENDIAN_LITTLE
  &quot;compression&quot;          =&gt; READSTAT_COMPRESS_NONE</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colmetadata(df, :myord)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, Any} with 8 entries:
  &quot;label&quot;         =&gt; &quot;ordinal&quot;
  &quot;format&quot;        =&gt; &quot;%16.0f&quot;
  &quot;display_width&quot; =&gt; 16
  &quot;measure&quot;       =&gt; READSTAT_MEASURE_UNKNOWN
  &quot;alignment&quot;     =&gt; READSTAT_ALIGNMENT_RIGHT
  &quot;type&quot;          =&gt; READSTAT_TYPE_INT8
  &quot;storage_width&quot; =&gt; 0x0000000000000001
  &quot;vallabel&quot;      =&gt; :myord</code></pre><h3 id="Converting-LabeledArray"><a class="docs-heading-anchor" href="#Converting-LabeledArray">Converting LabeledArray</a><a id="Converting-LabeledArray-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-LabeledArray" title="Permalink"></a></h3><p>Variables with value labels are stored in <a href="../value-labels/#ReadStatTables.LabeledArray"><code>LabeledArray</code></a>s. To convert a <code>LabeledArray</code> to another array type, we may either obtain an array of <a href="../value-labels/#ReadStatTables.LabeledValue"><code>LabeledValue</code></a>s or collect the values and labels separately. The data values can be directly retrieved by calling <a href="../value-labels/#DataAPI.refarray"><code>refarray</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; refarray(tb.mylabl)</code><code class="nohighlight hljs ansi" style="display:block;">5-element Vector{Union{Missing, Int8}}:
 1
 2
 1
 2
 1</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The array returned by <code>refarray</code> is exactly the same array underlying the <code>LabeledArray</code>. Therefore, modifying the elements of the array will also mutate the values in the associated <code>LabeledArray</code>.</p></div></div><p>If only the value labels are needed, we can obtain an iterator of the value labels via <a href="../value-labels/#ReadStatTables.valuelabels"><code>valuelabels</code></a>. For example, to convert a <code>LabeledArray</code> to a <code>CategoricalArray</code> from <a href="https://github.com/JuliaData/CategoricalArrays.jl">CategoricalArrays.jl</a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CategoricalArrays</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; CategoricalArray(valuelabels(tb.mylabl))</code><code class="nohighlight hljs ansi" style="display:block;">5-element CategoricalArray{String,1,UInt32}:
 &quot;Male&quot;
 &quot;Female&quot;
 &quot;Male&quot;
 &quot;Female&quot;
 &quot;Male&quot;</code></pre><p>It is also possible to only convert the type of the underlying data values:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; convertvalue(Int32, tb.mylabl)</code><code class="nohighlight hljs ansi" style="display:block;">5-element LabeledVector{Int32, Vector{Int32}, Union{Char, Int32}}:
 1 =&gt; Male
 2 =&gt; Female
 1 =&gt; Male
 2 =&gt; Female
 1 =&gt; Male</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.convertvalue" href="#ReadStatTables.convertvalue"><code>ReadStatTables.convertvalue</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convertvalue(T, x::LabeledArray)</code></pre><p>Convert the type of data values contained in <code>x</code> to <code>T</code>. This method is equivalent to <code>convert(AbstractArray{LabeledValue{T, K}, N}}, x)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/LabeledArrays.jl#L394-L399">source</a></section></article><h2 id="Writing-a-Data-File"><a class="docs-heading-anchor" href="#Writing-a-Data-File">Writing a Data File</a><a id="Writing-a-Data-File-1"></a><a class="docs-heading-anchor-permalink" href="#Writing-a-Data-File" title="Permalink"></a></h2><p>To write a table to a supported data file format:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Create a data frame for illustration
       df = DataFrame(readstat(&quot;data/alltypes.dta&quot;)); emptycolmetadata!(df)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr1">3×9 DataFrame
 Row │ vbyte      vint       vlong      vfloat     vdouble    vstr     vstrL   ⋯
     │<span class="sgr90"> LabeledV…  LabeledV…  LabeledV…  LabeledV…  LabeledV…  String3  String  ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ A          A          A          A          A          ab       This is ⋯
   2 │ missing    missing    missing    missing    missing
   3 │ missing    missing    missing    missing    missing
</span><span class="sgr36">                                                               3 columns omitted</span></span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; out = writestat(&quot;data/write_alltypes.dta&quot;, df)</code><code class="nohighlight hljs ansi" style="display:block;">3×9 ReadStatTable:
<span class="sgr1"> Row │          vbyte             vint            vlong             vfloat     ⋯
     │<span class="sgr90"> Labeled{Int8?}  Labeled{Int16?}  Labeled{Int32?}  Labeled{Float32?}  La ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │              A                A                A                  A     ⋯
   2 │        missing          missing          missing            missing     ⋯
   3 │        missing          missing          missing            missing     ⋯
</span><span class="sgr36">                                                               5 columns omitted</span></span></code></pre><p>The returned table <code>out</code> contains the actual data (including metadata) that are exposed to the writer.</p><p>Value labels attached to a <code>LabeledArray</code> are always preserved in the output file. If the input table contains any column of type <code>CategoricalArray</code> or <code>PooledArray</code>, value labels are created and written automatically by default:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PooledArrays</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[!,:vbyte] = CategoricalArray(valuelabels(df.vbyte))</code><code class="nohighlight hljs ansi" style="display:block;">3-element CategoricalArray{String,1,UInt32}:
 &quot;A&quot;
 &quot;missing&quot;
 &quot;missing&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[!,:vint] = PooledArray(valuelabels(df.vint))</code><code class="nohighlight hljs ansi" style="display:block;">3-element PooledVector{String, UInt32, Vector{UInt32}}:
 &quot;A&quot;
 &quot;missing&quot;
 &quot;missing&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; out = writestat(&quot;data/write_alltypes.dta&quot;, df)</code><code class="nohighlight hljs ansi" style="display:block;">3×9 ReadStatTable:
<span class="sgr1"> Row │           vbyte             vint            vlong             vfloat    ⋯
     │<span class="sgr90"> Labeled{Int32?}  Labeled{Int32?}  Labeled{Int32?}  Labeled{Float32?}  L ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │               A                A                A                  A    ⋯
   2 │         missing          missing          missing            missing    ⋯
   3 │         missing          missing          missing            missing    ⋯
</span><span class="sgr36">                                                               5 columns omitted</span></span></code></pre><p>Notice that in the returned table, the columns <code>vbyte</code> and <code>vint</code> are <code>LabeledArray</code>s:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; out.vbyte</code><code class="nohighlight hljs ansi" style="display:block;">3-element LabeledVector{Union{Missing, Int32}, SentinelArrays.SentinelVector{Int32, Int32, Missing, Vector{Int32}}, Union{Char, Int32}}:
 1 =&gt; A
 2 =&gt; missing
 2 =&gt; missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; out.vint</code><code class="nohighlight hljs ansi" style="display:block;">3-element LabeledVector{Union{Missing, Int32}, SentinelArrays.SentinelVector{Int32, Int32, Missing, Vector{Int32}}, Union{Char, Int32}}:
 1 =&gt; A
 2 =&gt; missing
 2 =&gt; missing</code></pre><p>It is possible to specify the format of certain variables. This can be important, for example, for variables representing date/time. In the above example, a default format has been selected:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; out.vdate</code><code class="nohighlight hljs ansi" style="display:block;">3-element mappedarray(ReadStatTables.Num2DateTime{Date, Dates.Day}(Date(&quot;1960-01-01&quot;), Dates.Day(1)), ReadStatTables.DateTime2Num{ReadStatTables.Num2DateTime{Date, Dates.Day}}(ReadStatTables.Num2DateTime{Date, Dates.Day}(Date(&quot;1960-01-01&quot;), Dates.Day(1))), ::SentinelArrays.SentinelVector{Int32, Int32, Missing, Vector{Int32}}) with eltype Union{Missing, Date}:
 1960-01-02
 missing
 missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colmetadata(out, :vdate, &quot;format&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;%td&quot;</code></pre><p>To specify a different format, a convenient approach is to specify the <code>varformat</code> keyword argument:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; out2 = writestat(&quot;data/write_alltypes.dta&quot;, df, varformat=Dict(:vdate=&gt;&quot;%tm&quot;));</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; out2.vdate</code><code class="nohighlight hljs ansi" style="display:block;">3-element mappedarray(ReadStatTables.Num2DateTime{Date, Dates.Month}(Date(&quot;1960-01-01&quot;), Dates.Month(1)), ReadStatTables.DateTime2Num{ReadStatTables.Num2DateTime{Date, Dates.Month}}(ReadStatTables.Num2DateTime{Date, Dates.Month}(Date(&quot;1960-01-01&quot;), Dates.Month(1))), ::SentinelArrays.SentinelVector{Int32, Int32, Missing, Vector{Int32}}) with eltype Union{Missing, Date}:
 1960-01-01
 missing
 missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colmetadata(out2, :vdate, &quot;format&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">&quot;%tm&quot;</code></pre><p>Notice that since the format <code>&quot;%tm&quot;</code> is for months, the day within a month has been ignored and becomes 1 for the printed value of <code>Date</code> in the above example.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>When a variable has a Stata format <code>&quot;%tw&quot;</code>, <code>&quot;%tm&quot;</code>, <code>&quot;%tq&quot;</code> or <code>&quot;%th&quot;</code>, a displayed <code>Date</code> is always the first day within the corresponding Stata period. In particular, Stata counts week numbers starting from the first day of each year and hence a displayed <code>Date</code> may not correspond to the first day of a calendar week.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The write support is experimental and requires further testing. Caution should be taken when writing the data files.</p></div></div><h2 id="More-Options"><a class="docs-heading-anchor" href="#More-Options">More Options</a><a id="More-Options-1"></a><a class="docs-heading-anchor-permalink" href="#More-Options" title="Permalink"></a></h2><p>The behavior of <code>readstat</code> can be adjusted by passing keyword arguments:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.readstat" href="#ReadStatTables.readstat"><code>ReadStatTables.readstat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readstat(filepath; kwargs...)</code></pre><p>Return a <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a> that collects data (including metadata) from a supported data file located at <code>filepath</code>.</p><p><strong>Supported File Formats</strong></p><ul><li>Stata: <code>.dta</code></li><li>SAS: <code>.sas7bdat</code> and <code>.xpt</code></li><li>SPSS: <code>.sav</code> and <code>por</code></li></ul><p><strong>Keywords</strong></p><ul><li><code>ext = lowercase(splitext(filepath)[2])</code>: extension of data file for choosing the parser.</li><li><code>usecols::Union{ColumnSelector, Nothing} = nothing</code>: only collect data from the specified columns (variables); collect all columns if <code>usecols=nothing</code>.</li><li><code>row_limit::Union{Integer, Nothing} = nothing</code>: restrict the total number of rows to be read; read all rows if <code>row_limit=nothing</code>.</li><li><code>row_offset::Integer = 0</code>: skip the specified number of rows.</li><li><code>ntasks::Union{Integer, Nothing} = nothing</code>: number of tasks spawned to read data file in concurrent chunks with multiple threads; with <code>ntasks</code> being <code>nothing</code> or smaller than 1, select a default value based on the size of data file and the number of threads available (<code>Threads.nthreads()</code>); not applicable to <code>.xpt</code> and <code>.por</code> files where row count is unknown from metadata.</li><li><code>apply_value_labels::Bool = true</code>: apply value labels to the associated columns.</li><li><code>inlinestring_width::Integer = ext ∈ (&quot;.sav&quot;, &quot;.por&quot;) ? 0 : 32</code>: use a fixed-width string type that can be stored inline for any string variable with width below <code>inlinestring_width</code> and <code>pool_width</code>; a non-positive value avoids using any inline string type; not recommended for SPSS files.</li><li><code>pool_width::Integer = 64</code>: only attempt to use <code>PooledArray</code> for string variables with width of at least 64.</li><li><code>pool_thres::Integer = 500</code>: do not use <code>PooledArray</code> for string variables if the number of unique values exceeds <code>pool_thres</code>; a non-positive value avoids using <code>PooledArray</code>.</li><li><code>file_encoding::Union{String, Nothing} = nothing</code>: manually specify the file character encoding; need to be an <code>iconv</code>-compatible name.</li><li><code>handler_encoding::Union{String, Nothing} = nothing</code>: manually specify the handler character encoding; default to UTF-8.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/readstat.jl#L28-L48">source</a></section></article><p>The accepted types of values for selecting certain variables (data columns) are shown below:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.ColumnIndex" href="#ReadStatTables.ColumnIndex"><code>ReadStatTables.ColumnIndex</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ColumnIndex</code></pre><p>A type union for values accepted by <a href="#ReadStatTables.readstat"><code>readstat</code></a> and <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a> for selecting a column. A column can be selected either with the column name as <code>Symbol</code> or <code>String</code>; or with an integer (<code>Int</code>) index based on the position in a table. See also <a href="#ReadStatTables.ColumnSelector"><code>ColumnSelector</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/table.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.ColumnSelector" href="#ReadStatTables.ColumnSelector"><code>ReadStatTables.ColumnSelector</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ColumnSelector</code></pre><p>A type union for values accepted by <a href="#ReadStatTables.readstat"><code>readstat</code></a> for selecting a single column or multiple columns. The accepted values can be of type <a href="#ReadStatTables.ColumnIndex"><code>ColumnIndex</code></a>, a <code>UnitRange</code> of integers, an array or a set of <a href="#ReadStatTables.ColumnIndex"><code>ColumnIndex</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/readstat.jl#L1-L8">source</a></section></article><p>File-level metadata can be obtained without reading the entire data file:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.readstatmeta" href="#ReadStatTables.readstatmeta"><code>ReadStatTables.readstatmeta</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readstatmeta(filepath; kwargs...)</code></pre><p>Return a <a href="../metadata/#ReadStatTables.ReadStatMeta"><code>ReadStatMeta</code></a> that collects file-level metadata without reading the full data from a supported data file located at <code>filepath</code>. See also <a href="#ReadStatTables.readstatallmeta"><code>readstatallmeta</code></a>.</p><p><strong>Supported File Formats</strong></p><ul><li>Stata: <code>.dta</code></li><li>SAS: <code>.sas7bdat</code> and <code>.xpt</code></li><li>SPSS: <code>.sav</code> and <code>por</code></li></ul><p><strong>Keywords</strong></p><ul><li><code>ext = lowercase(splitext(filepath)[2])</code>: extension of data file for choosing the parser.</li><li><code>file_encoding::Union{String, Nothing} = nothing</code>: manually specify the file character encoding; need to be an <code>iconv</code>-compatible name.</li><li><code>handler_encoding::Union{String, Nothing} = nothing</code>: manually specify the handler character encoding; default to UTF-8.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/readstat.jl#L145-L159">source</a></section></article><p>To additionally collect variable-level metadata and all value labels:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.readstatallmeta" href="#ReadStatTables.readstatallmeta"><code>ReadStatTables.readstatallmeta</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readstatallmeta(filepath; kwargs...)</code></pre><p>Return all metadata including value labels without reading the full data from a supported data file located at <code>filepath</code>. The four returned objects are for file-level metadata, variable names, variable-level metadata and value labels respectively. See also <a href="#ReadStatTables.readstatmeta"><code>readstatmeta</code></a>.</p><p><strong>Supported File Formats</strong></p><ul><li>Stata: <code>.dta</code></li><li>SAS: <code>.sas7bdat</code> and <code>.xpt</code></li><li>SPSS: <code>.sav</code> and <code>por</code></li></ul><p><strong>Keywords</strong></p><ul><li><code>ext = lowercase(splitext(filepath)[2])</code>: extension of data file for choosing the parser.</li><li><code>usecols::Union{ColumnSelector, Nothing} = nothing</code>: only collect variable-level metadata from the specified columns (variables); collect all columns if <code>usecols=nothing</code>.</li><li><code>file_encoding::Union{String, Nothing} = nothing</code>: manually specify the file character encoding; need to be an <code>iconv</code>-compatible name.</li><li><code>handler_encoding::Union{String, Nothing} = nothing</code>: manually specify the handler character encoding; default to UTF-8.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/readstat.jl#L184-L200">source</a></section></article><p>For writing tables to data files, one may gain more control by first converting a table to a <code>ReadStatTable</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.writestat" href="#ReadStatTables.writestat"><code>ReadStatTables.writestat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">writestat(filepath, table; ext = lowercase(splitext(filepath)[2]), kwargs...)</code></pre><p>Write a <code>Tables.jl</code>-compatible <code>table</code> to <code>filepath</code> as a data file supported by <code>ReadStat</code>. File format is determined based on the extension contained in <code>filepath</code> and may be overriden by the <code>ext</code> keyword.</p><p>Any user-provided <code>table</code> is converted to a <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a> first before being handled by a <code>ReadStat</code> writer. Therefore, to gain fine-grained control over the content to be written, especially for metadata, one may directly work with a <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a> (possibly converted from another table type such as <code>DataFrame</code> from <code>DataFrames.jl</code>) before passing it to <code>writestat</code>. Alternatively, one may pass any keyword argument accepted by a constructor of <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a> to <code>writestat</code>. The actual <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a> handled by the writer is returned after the writer finishes.</p><p><strong>Supported File Formats</strong></p><ul><li>Stata: <code>.dta</code></li><li>SAS: <code>.sas7bdat</code> and <code>.xpt</code> (Note: SAS may not recognize the produced <code>.sas7bdat</code> files due to a known limitation with ReadStat.)</li><li>SPSS: <code>.sav</code> and <code>por</code></li></ul><p><strong>Conversion</strong></p><p>For data values, Julia objects are converted to the closest <code>ReadStat</code> type for either numerical values or strings. However, depending on the file format of the output file, a data column may be written in a different type when the closest <code>ReadStat</code> type is not supported.</p><p>For metadata, if the user-provided <code>table</code> is not a <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a>, an attempt will be made to collect table-level or column-level metadata with a key that matches a metadata field in <a href="../metadata/#ReadStatTables.ReadStatMeta"><code>ReadStatMeta</code></a> or <a href="../metadata/#ReadStatTables.ReadStatColMeta"><code>ReadStatColMeta</code></a> via the <code>metadata</code> and <code>colmetadata</code> interface defined by <code>DataAPI.jl</code>. If the <code>table</code> is a <a href="../table-interface/#ReadStatTables.ReadStatTable"><code>ReadStatTable</code></a>, then the associated metadata will be written as long as their values are compatible with the format of the output file. Value labels associated with a <a href="../value-labels/#ReadStatTables.LabeledArray"><code>LabeledArray</code></a> are always preserved even when the name of the dictionary of value labels is not specified in metadata (column name will be used by default). If a column is of an array type that makes use of <code>DataAPI.refpool</code> (e.g., <code>CategoricalArray</code> and <code>PooledArray</code>), value labels will be generated automatically by default (with keyword <code>refpoolaslabel</code> set to be <code>true</code>) and the underlying numerical reference values instead of the values returned by <code>getindex</code> are written to files (with value labels attached).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/writestat.jl#L286-L334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.ReadStatTable-Tuple{Any, AbstractString}" href="#ReadStatTables.ReadStatTable-Tuple{Any, AbstractString}"><code>ReadStatTables.ReadStatTable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReadStatTable(table, ext::AbstractString; kwargs...)</code></pre><p>Construct a <code>ReadStatTable</code> by wrapping a <code>Tables.jl</code>-compatible column table for a supported file format with extension <code>ext</code>. An attempt is made to collect table-level or column-level metadata with a key that matches a metadata field in <a href="../metadata/#ReadStatTables.ReadStatMeta"><code>ReadStatMeta</code></a> or <a href="../metadata/#ReadStatTables.ReadStatColMeta"><code>ReadStatColMeta</code></a> via the <code>metadata</code> and <code>colmetadata</code> interface defined by <code>DataAPI.jl</code>.</p><p>This method is used by <a href="#ReadStatTables.writestat"><code>writestat</code></a> when the provided <code>table</code> is not already a <code>ReadStatTable</code>. Hence, it is useful for gaining fine-grained control over the content to be written. Metadata may be manually specified with keyword arguments.</p><p>Any <code>missing</code> existing in string columns will be replaced by an empty string <code>&quot;&quot;</code>. A column with element type <code>Missing</code> is treated as a column with empty strings.</p><p><strong>Keywords</strong></p><ul><li><code>copycols::Bool = true</code>: copy data columns to <code>ReadStatColumns</code>; this is required for writing columns of date/time values (that are not already represented by numeric values).</li><li><code>refpoolaslabel::Bool = true</code>: generate value labels for columns of an array type that makes use of <code>DataAPI.refpool</code> (e.g., <code>CategoricalArray</code> and <code>PooledArray</code>).</li><li><code>vallabels::Dict{Symbol, Dict} = Dict{Symbol, Dict}()</code>: a dictionary of all value label dictionaries indexed by their names.</li><li><code>hasmissing::Vector{Bool} = Vector{Bool}()</code>: a vector of indicators for whether any missing value present in the corresponding column; irrelavent for writing tables.</li><li><code>meta::ReadStatMeta = ReadStatMeta()</code>: file-level metadata.</li><li><code>colmeta::ColMetaVec = ReadStatColMetaVec()</code>: variable-level metadata stored in a <code>StructArray</code> of <code>ReadStatColMeta</code>s; values are always overwritten.</li><li><code>varformat::Union{Dict{Symbol,String}, Nothing} = nothing</code>: specify variable-level format for certain variables with the key being the variable name (as <code>Symbol</code>) and value being the format string.</li><li><code>styles::Dict{Symbol, Symbol} = _default_metastyles()</code>: metadata styles.</li><li><code>maxdispwidth::Integer = 60</code>: maximum <code>display_width</code> set for any variable.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/writestat.jl#L68-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ReadStatTables.ReadStatTable-Tuple{ReadStatTable, AbstractString}" href="#ReadStatTables.ReadStatTable-Tuple{ReadStatTable, AbstractString}"><code>ReadStatTables.ReadStatTable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReadStatTable(table::ReadStatTable, ext::AbstractString; kwargs...)</code></pre><p>Construct a <code>ReadStatTable</code> from an existing <code>ReadStatTable</code> for a supported file format with extension <code>ext</code>.</p><p><strong>Keywords</strong></p><ul><li><code>update_width::Bool = true</code>: determine the storage width for each string variable by checking the actual data columns instead of any existing metadata value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junyuan-chen/ReadStatTables.jl/blob/1f09cca0ed3da7b2f197c874f5ef608f4d279f3a/src/writestat.jl#L246-L254">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>The printed output is generated with <a href="https://github.com/ronisbr/PrettyTables.jl">PrettyTables.jl</a>.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>The time types <code>Date</code> and <code>DateTime</code> are from the <a href="https://docs.julialang.org/en/v1/stdlib/Dates/">Dates</a> module of Julia.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../table-interface/">Table Interface »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Monday 28 April 2025 19:33">Monday 28 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
